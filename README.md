# Bank widget

## Описание
IT-отдел крупного банка делает новую фичу для личного кабинета клиента. 
Это виджет, который показывает несколько последних успешных банковских операций клиента. 
Вам доверили реализовать этот проект, который на бэкенде будет готовить данные для отображения в новом виджете.

## Информация для пользователей
### В настоящее время реализовано несколько полезных функций для виджета:
+ в модуле **masks.py** реализована функция маскировки номера банковской карты и счета пользователя.
+ в модуле **widget.py** также доступна функция маски номера карты или счета, а также реализована функция форматирования даты и приведения её к виду `"ДД.ММ.ГГГГ"`.
+ в модуле **processing.py** реализованы функции по работе с банковскими операциями пользователя. В частности в модуле содержится функция фильтрации операций по статусу *"Исполненная"* и *"Отмененная"*, а также функция сортировки банковских операций по дате проведения.
+ в модуле **generators.py** для работы доступны функции фильтра транкзаций по выбранной пользователем валюте, вывода описания произведенных ранее операций, а также возможность генерации номера банковских карт в указанном диапазоне.
+ в модуле **decorators** размещаются декораторы, в том числе декоратор log, который логирует работу и выполнение принимаемой функции, а также выводит сведения об ошибках.

_Данные модули прошли проверку тестами на валидность и работоспособность!_

Функционал и возможности виджета будут развиваться и пополняться.

## Тестирование
В ходе тестирования кода было выполнен ряд проверок и отладки отдельных блоков:

**Модуль masks**  

Функция `get_mask_card_number`:
+ Правильность маскирования номера карты.
+ Параметризованные тесты для проверки работы функции на различных входных форматах номеров карт.
+ Обработка исключения _ValueError_ при случаях, когда номер карты введен некорректно или имеет неправильную длину, нулевое или строчное (буквенное) значение. 

Функция `get_mask_account`:
+ Проверка правильности маскирования номера счета.
+ Тестирование с помощью параметризации работы функции с различными форматами и длинами номеров счетов.
+ Обработка исключения _ValueError_ при случаях, когда длина счета меньше ожидаемой длины, а также при введении нулевого или строчного (буквенного) значений.

**Модуль widget**  

Функция `mask_account_card`:
+ Проверка, что функция корректно распознает и применяет нужный тип маскировки в зависимости от типа входных данных (карта или счет).
+ Параметризованные тесты с разными типами карт и счетов для проверки универсальности функции.
+ Обработка исключения _ValueError_ при случаях, когда функция получает пустую или некорректную для неё строку для обработки.

Функция `get_data`:
+ Проверка правильности преобразования даты.
+ Тестирование с помощью параметризации работы функции на различных входных форматах даты.

**Модуль processing**  

Функция `filter_by_state`:
+ Тестирование фильтрации списка словарей по заданному ключу `state`
+ Параметризация тестов, а также использование фикстур для проверки различных возможных значений статуса `state`.

Функция `sort_by_date`:
+ Тестирование сортировки списка словарей по датам в порядке убывания и возрастания.
+ Параметризация тестов, а также использование фикстур для проверки работы с массивами различных данных.

**Модуль generators**

Функция `filter_by_currency`:
+ Проверка корректной фильтрации списка транзакций по заданной валюте.
+ Обработано исключение, если генератор принимает пустой список.

Тестирование функции `transaction_descriptions`:
+ Проверено, что функция возвращает корректные описания для каждой транзакции.
+ Тестирование случаев, когда описание операции не указано, выведение соответствующей информации.
+ Обработано исключение _ValueError_ в случаях, когда функция принимает пустой список.

Тестирование генератора `card_number_generator`:
+ Проверка, что генератор выдает правильные номера карт в заданном диапазоне.
+ Проверена корректность форматирования номеров карт.

**Модуль decorators**

Декоратор `log`:
+ Декоратор должен принимать необязательный аргумент `filename`, который определяет, куда будут записываться логи (в файл или в консоль):
    - Если `filename` задан, логи записываются в указанный файл.
    - Если `filename` не задан, логи выводятся в консоль.
+ При успешно выполненной функции декоратор выводит сообщение с именем функции и её успешном окончании работы (или сохраняет сообщение в файл.txt)
+ При выпадении ошибки происходит вывод о типе ошибки и аргументах функции с её именем.

### Общие аспекты тестирования
**Фикстуры.** 
Все фикстуры для тестов модуля **processing** и свежего модуля **generators** перенесены в единый модуль **conftest.py**

**Покрытие тестами.** 
Все ветви кода и исключения, которые могут быть сгенерированы функциями, тестируются.
Покрытие тестами составляет 95% кода


## Документация
Узнать более подробно о проекте и реализованных функциях можно по следующим ссылкам:
- [функция маски](Homework_9.1.md)
- [виджет](Homework_9.2.md)
- [работа с банковскими операциями (сортировка по ключу и дате)](Homework_10.1.md)
- [генераторы](Homework_11.1.md)
- [тестировка функций](Homework_10.2.md)
- [декораторы](Homework_11.2.md)
